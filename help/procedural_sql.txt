El procedural se crea directamente en MySQL

Por ejemplo:

    Para la consulta Obtener genero más comprado en Santiago

        DELIMITER //
        CREATE PROCEDURE ObtenerGeneroMasCompradoEnSantiago()
        BEGIN
            SELECT genero, COUNT(*) AS compras
            FROM Pedido p
            JOIN Cliente c ON p.id_cliente = c.id_cliente
            JOIN Libro l ON p.titulo_libro = l.titulo_libro
            WHERE c.comuna = 'Santiago'
            GROUP BY genero
            ORDER BY compras DESC
            LIMIT 1;
        END //
        DELIMITER ;

    Después en el Backend
        CALL ObtenerGeneroMasCompradoEnSantiago();

Ejemplo de implementación   

    const mysql = require('mysql2');

    const connection = mysql.createConnection({
        host: 'localhost',
        user: 'root',
        password: 'password',
        database: 'Librería_RIW'
    });

    connection.query('CALL ObtenerGeneroMasCompradoEnSantiago()', (err, results) => {
        if (err) throw err;
        console.log(results);
    });

