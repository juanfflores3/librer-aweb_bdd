CREATE DATABASE Librer√≠a_RIW;

CREATE TABLE Autor (
	id_autor INT PRIMARY KEY,
	nombre VARCHAR(35) NOT NULL,
	pais_origen VARCHAR(35)
);

CREATE TABLE Sucursal (
	id_sucursal INT PRIMARY KEY,
	nombre VARCHAR(35),
	telefono VARCHAR(15),
	horario VARCHAR(20)
);

CREATE TABLE Editorial (
	id_editorial INT PRIMARY KEY,
	nombre VARCHAR(50),
	direccion VARCHAR(150),
	pais_origen VARCHAR(35)
);

CREATE TABLE Membresia (
	id_membresia INT PRIMARY KEY,
	tipo VARCHAR(20),
	costo_mensual INT,
	beneficios VARCHAR(120)
);

CREATE TABLE Cliente (
	id_cliente INT PRIMARY KEY,
	id_membresia INT,
	nombre VARCHAR(50),
	email VARCHAR(300),
	telefono VARCHAR(15),
	direccion VARCHAR(150),
	comuna VARCHAR(50),
	fecha_registro DATE,
	FOREIGN KEY (id_membresia) REFERENCES Membresia(id_membresia)
);

CREATE TABLE Libro (
	titulo_libro VARCHAR(50) PRIMARY KEY,
	numero_paginas INT,
	genero VARCHAR(35),
	categoria VARCHAR(35),
	ano_publicacion INT,
	id_editorial INT,
	FOREIGN KEY (id_editorial) REFERENCES Editorial(id_editorial)
);

CREATE TABLE Empleado (
	id_empleado INT PRIMARY KEY,
	id_sucursal INT,
	nombre VARCHAR(35),
	telefono VARCHAR(15),
	email VARCHAR(150),
	cargo VARCHAR(50),
	sueldo INT,
	fecha_contratacion DATE,
	FOREIGN KEY (id_sucursal) REFERENCES Sucursal(id_sucursal)
);

CREATE TABLE Proveedor (
	id_proveedor INT PRIMARY KEY,
	nombre VARCHAR(35),
	direccion VARCHAR(150),
	telefono VARCHAR(15),
	email VARCHAR(150),
	pais VARCHAR(35)
);

CREATE TABLE Escribe (
	id_autor INT,
	titulo_libro VARCHAR(50),
	fecha_escrito DATE,
	PRIMARY KEY (id_autor, titulo_libro),
	FOREIGN KEY (id_autor) REFERENCES Autor(id_autor),
	FOREIGN KEY (titulo_libro) REFERENCES Libro(titulo_libro)
);

CREATE TABLE Inventario (
	id_sucursal INT,
	titulo_libro VARCHAR(50),
	stock INT,
	precio INT,
	PRIMARY KEY (id_sucursal, titulo_libro),
	FOREIGN KEY (id_sucursal) REFERENCES Sucursal(id_sucursal),
	FOREIGN KEY (titulo_libro) REFERENCES Libro(titulo_libro)
);

CREATE TABLE Pedido (
	id_pedido INT AUTO_INCREMENT,
	id_cliente INT,
	titulo_libro VARCHAR(50),
	fecha_compra DATE,
	PRIMARY KEY(id_pedido),
	FOREIGN KEY (id_cliente) REFERENCES Cliente(id_cliente),
	FOREIGN KEY (titulo_libro) REFERENCES Libro(titulo_libro)
);

CREATE TABLE Devolucion (
	id_cliente INT,
	titulo_libro VARCHAR(50),
	fecha_devolucion DATE,
	motivo VARCHAR(200),
	PRIMARY KEY (id_cliente, titulo_libro),
	FOREIGN KEY (id_cliente) REFERENCES Cliente(id_cliente),
	FOREIGN KEY (titulo_libro) REFERENCES Libro(titulo_libro)
);

CREATE TABLE Envio (
	id_cliente INT,
	id_sucursal INT,
	titulo_libro VARCHAR(50),
	direccion VARCHAR(150),
	cantidad INT,
	fecha_enviado DATE,
	fecha_entregado DATE,
	PRIMARY KEY (id_cliente, id_sucursal, titulo_libro),
	FOREIGN KEY (id_cliente) REFERENCES Cliente(id_cliente),
	FOREIGN KEY (id_sucursal) REFERENCES Sucursal(id_sucursal),
	FOREIGN KEY (titulo_libro) REFERENCES Libro(titulo_libro)
);

CREATE TABLE Suministra (
	id_proveedor INT,
	titulo_libro VARCHAR(50),
	fecha_suministro DATE,
	PRIMARY KEY (id_proveedor, titulo_libro),
	FOREIGN KEY (id_proveedor) REFERENCES Proveedor(id_proveedor),
	FOREIGN KEY (titulo_libro) REFERENCES Libro(titulo_libro)
);
